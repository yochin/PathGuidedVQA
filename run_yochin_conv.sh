# test using examples with multiple images

# two examples --> no output
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./examples/images/045_GOPR1621.jpg,./sample100/images/001_R0018445.jpg" --query "USER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, describe the overall photo from near to far. Second, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Third, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: 1. The image you've provided shows a city street scene from the perspective of a pedestrian at a crosswalk, looking towards a traffic signal which is currently red for pedestrians. In the foreground, there's a marked pedestrian crossing with white zebra stripes on the right side. Stop line for vehicles is on the left side. In the middle ground, there are several vehicles: a truck on the left side of the road, and multiple cars and trucks further back on the right side. They appear to be in motion, suggesting active traffic. The vehicles are positioned in such a way that they are not obstructing the pedestrian crossing directly in front of the viewer. The sky is overcast, suggesting a cloudy day. To reach the destination, which is the pedestrian traffic light, you would wait for the traffic light to turn green, ensuring that all vehicles have come to a complete stop. Once it's safe, starting from the center, you would need to move slightly to the right and then forward towards the crosswalk. You would proceed straight across the zebra crossing to the other side of the street, while being mindful of the traffic and following the pedestrian signals. The path is clear, with no immediate obstacles on the pedestrian crossing itself, but caution is always necessary due to the active traffic. 2. Starting from the bottom-center, move right slightly, then forward towards the crosswalk, crossing it when it's safe, and head towards the pedestrian traffic light while being cautious of vehicles when it turns green. 3. STOP. The pedestrian traffic light is red, indicating it is not safe to cross.\nUSER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, describe the overall photo from near to far. Second, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Third, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: 1. This image shows an urban street scene with various vehicles and a pedestrian, viewed from the perspective of someone standing on a sidewalk near a crosswalk. In the foreground, we see a wide pedestrian crossing area with white and red sections on the pavement on the left side, indicating different zones for crossing. The closest lane to the viewer is clear, but there are several vehicles in the lanes ahead: cars, a motorcycle, and trucks. Traffic lights for vehicles on the right side are visible further ahead, some showing red. There is also a pedestrian traffic light showing green on the left side of the crosswalk, indicating it is safe for pedestrians to cross. To navigate towards the pedestrian traffic light showing a green signal, one would move slightly to the left, step off the curb and cross the crosswalk, paying attention to any potential vehicles turning right. As you approach the middle of the crosswalk, you should be mindful of the motorcycle on the right side and the car on the left side in the lanes directly ahead. Since the pedestrian light is green, these vehicles should be stopped, but always exercise caution and make sure they are not moving before you proceed. After passing these vehicles, continue straight ahead towards the green pedestrian traffic light, ensuring there are no turning vehicles or other unexpected obstacles. Itâ€™s important to stay alert and watch for the movement of vehicles and any other pedestrians that may influence the safest path to your destination.2. Head straight across the crosswalk for about 30 meters towards the green pedestrian traffic light, while being cautious of the vehicles on your left and the motorcycle on your right.3. GO. The pedestrian traffic light is green, indicating it is safe to walk across the crosswalk, but remain cautious of the motorcycle ahead on the right side.\nUSER: The image contains obstacles, person [0.57, 0.42, 0.59, 0.54], movable_signage [0.03, 0.3, 0.1, 0.6], person [0.66, 0.39, 0.7, 0.56], person [0.89, 0.36, 0.96, 0.59], movable_signage [0.78, 0.25, 0.89, 0.63], subway ticket gate each [0.08, 0.46, 0.19, 0.62], subway ticket gate each [0.17, 0.46, 0.28, 0.63], subway ticket gate each [0.26, 0.46, 0.36, 0.62], subway ticket gate each [0.35, 0.46, 0.43, 0.63], subway ticket gate each [0.45, 0.46, 0.5, 0.63], subway ticket gate each [0.55, 0.45, 0.58, 0.64], subway ticket gate each [0.62, 0.46, 0.68, 0.64], subway ticket gate each [0.69, 0.45, 0.79, 0.63], subway ticket gate all [0.07, 0.46, 0.79, 0.63], subway ticket gate handicap [0.87, 0.39, 1.0, 0.63], subway ticket gate all [0.87, 0.39, 1.0, 0.63]. First, describe the overall photo from near to far. Second, explain the path to the destination, subway ticket gate each [0.35, 0.46, 0.43, 0.63], paying attention to obstacles along the path in 1 line. Third, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: "

# one examples --> no output
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./sample100/images/001_R0018445.jpg" --query "USER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, describe the overall photo from near to far. Second, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Third, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: 1. The image you've provided shows a city street scene from the perspective of a pedestrian at a crosswalk, looking towards a traffic signal which is currently red for pedestrians. In the foreground, there's a marked pedestrian crossing with white zebra stripes on the right side. Stop line for vehicles is on the left side. In the middle ground, there are several vehicles: a truck on the left side of the road, and multiple cars and trucks further back on the right side. They appear to be in motion, suggesting active traffic. The vehicles are positioned in such a way that they are not obstructing the pedestrian crossing directly in front of the viewer. The sky is overcast, suggesting a cloudy day. To reach the destination, which is the pedestrian traffic light, you would wait for the traffic light to turn green, ensuring that all vehicles have come to a complete stop. Once it's safe, starting from the center, you would need to move slightly to the right and then forward towards the crosswalk. You would proceed straight across the zebra crossing to the other side of the street, while being mindful of the traffic and following the pedestrian signals. The path is clear, with no immediate obstacles on the pedestrian crossing itself, but caution is always necessary due to the active traffic. 2. Starting from the bottom-center, move right slightly, then forward towards the crosswalk, crossing it when it's safe, and head towards the pedestrian traffic light while being cautious of vehicles when it turns green. 3. STOP. The pedestrian traffic light is red, indicating it is not safe to cross.\nUSER: The image contains obstacles, person [0.57, 0.42, 0.59, 0.54], movable_signage [0.03, 0.3, 0.1, 0.6], person [0.66, 0.39, 0.7, 0.56], person [0.89, 0.36, 0.96, 0.59], movable_signage [0.78, 0.25, 0.89, 0.63], subway ticket gate each [0.08, 0.46, 0.19, 0.62], subway ticket gate each [0.17, 0.46, 0.28, 0.63], subway ticket gate each [0.26, 0.46, 0.36, 0.62], subway ticket gate each [0.35, 0.46, 0.43, 0.63], subway ticket gate each [0.45, 0.46, 0.5, 0.63], subway ticket gate each [0.55, 0.45, 0.58, 0.64], subway ticket gate each [0.62, 0.46, 0.68, 0.64], subway ticket gate each [0.69, 0.45, 0.79, 0.63], subway ticket gate all [0.07, 0.46, 0.79, 0.63], subway ticket gate handicap [0.87, 0.39, 1.0, 0.63], subway ticket gate all [0.87, 0.39, 1.0, 0.63]. First, describe the overall photo from near to far. Second, explain the path to the destination, subway ticket gate each [0.35, 0.46, 0.43, 0.63], paying attention to obstacles along the path in 1 line. Third, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: "

# one examples w/o description --> incorrect answer (very short, just description)
# max_new_token * 4 --> still incorrect answer
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./sample100/images/001_R0018445.jpg" --query "USER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: 1. Starting from the bottom-center, move right slightly, then forward towards the crosswalk, crossing it when it's safe, and head towards the pedestrian traffic light while being cautious of vehicles when it turns green. \n2. STOP. The pedestrian traffic light is red, indicating it is not safe to cross.\nUSER: The image contains obstacles, person [0.57, 0.42, 0.59, 0.54], movable_signage [0.03, 0.3, 0.1, 0.6], person [0.66, 0.39, 0.7, 0.56], person [0.89, 0.36, 0.96, 0.59], movable_signage [0.78, 0.25, 0.89, 0.63], subway ticket gate each [0.08, 0.46, 0.19, 0.62], subway ticket gate each [0.17, 0.46, 0.28, 0.63], subway ticket gate each [0.26, 0.46, 0.36, 0.62], subway ticket gate each [0.35, 0.46, 0.43, 0.63], subway ticket gate each [0.45, 0.46, 0.5, 0.63], subway ticket gate each [0.55, 0.45, 0.58, 0.64], subway ticket gate each [0.62, 0.46, 0.68, 0.64], subway ticket gate each [0.69, 0.45, 0.79, 0.63], subway ticket gate all [0.07, 0.46, 0.79, 0.63], subway ticket gate handicap [0.87, 0.39, 1.0, 0.63], subway ticket gate all [0.87, 0.39, 1.0, 0.63]. First, explain the path to the destination, subway ticket gate each [0.35, 0.46, 0.43, 0.63], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: "

# say two image difference. So, VLM is working. But example prompt is not proper.
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./sample100/images/001_R0018445.jpg" --query "just compare two images and say the difference"

# two examples w/o description --> explain other image
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./examples/images/045_GOPR1621.jpg,./sample100/images/001_R0018445.jpg" --query "USER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. \n<image-placeholder>\nASSISTANT: 1. Starting from the bottom-center, move right slightly, then forward towards the crosswalk, crossing it when it's safe, and head towards the pedestrian traffic light while being cautious of vehicles when it turns green. 2. STOP. The pedestrian traffic light is red, indicating it is not safe to cross.\nUSER: The image contains obstacles, truck [0.02, 0.41, 0.25, 0.51], car [0.69, 0.5, 0.73, 0.53], car [0.75, 0.5, 0.79, 0.53], truck [0.71, 0.49, 0.75, 0.52], truck [0.66, 0.48, 0.69, 0.52], car [0.91, 0.52, 0.96, 0.54], pedestrian traffic light red [0.52, 0.44, 0.53, 0.46]. First, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. \n<image-placeholder>\nASSISTANT: 1. Head straight across the crosswalk for about 30 meters towards the green pedestrian traffic light, while being cautious of the vehicles on your left and the motorcycle on your right. 2. GO. The pedestrian traffic light is green, indicating it is safe to walk across the crosswalk, but remain cautious of the motorcycle ahead on the right side.\nUSER: The image contains obstacles, person [0.57, 0.42, 0.59, 0.54], movable_signage [0.03, 0.3, 0.1, 0.6], person [0.66, 0.39, 0.7, 0.56], person [0.89, 0.36, 0.96, 0.59], movable_signage [0.78, 0.25, 0.89, 0.63], subway ticket gate each [0.08, 0.46, 0.19, 0.62], subway ticket gate each [0.17, 0.46, 0.28, 0.63], subway ticket gate each [0.26, 0.46, 0.36, 0.62], subway ticket gate each [0.35, 0.46, 0.43, 0.63], subway ticket gate each [0.45, 0.46, 0.5, 0.63], subway ticket gate each [0.55, 0.45, 0.58, 0.64], subway ticket gate each [0.62, 0.46, 0.68, 0.64], subway ticket gate each [0.69, 0.45, 0.79, 0.63], subway ticket gate all [0.07, 0.46, 0.79, 0.63], subway ticket gate handicap [0.87, 0.39, 1.0, 0.63], subway ticket gate all [0.87, 0.39, 1.0, 0.63]. First, explain the path to the destination, subway ticket gate each [0.35, 0.46, 0.43, 0.63], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: "

# two examples w/o desc. & od result --> very short & incorrect answer: clouds in the sky.
python -m llava.eval.run_llava --model-path ./WEIGHTS/llava-v1.6-34b --image-file "./examples/images/045_GOPR1615.jpg,./examples/images/045_GOPR1621.jpg,./sample100/images/001_R0018445.jpg" --query "USER: First, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. \n<image-placeholder>\nASSISTANT: 1. Starting from the bottom-center, move right slightly, then forward towards the crosswalk, crossing it when it's safe, and head towards the pedestrian traffic light while being cautious of vehicles when it turns green. 2. STOP. The pedestrian traffic light is red, indicating it is not safe to cross.\nUSER: First, explain the path to the destination, pedestrian traffic light red [0.52, 0.44, 0.53, 0.46], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. \n<image-placeholder>\nASSISTANT: 1. Head straight across the crosswalk for about 30 meters towards the green pedestrian traffic light, while being cautious of the vehicles on your left and the motorcycle on your right. 2. GO. The pedestrian traffic light is green, indicating it is safe to walk across the crosswalk, but remain cautious of the motorcycle ahead on the right side.\nUSER: First, explain the path to the destination, subway ticket gate each [0.35, 0.46, 0.43, 0.63], paying attention to obstacles along the path in 1 line. Second, choose GO or STOP with the reason in 1 line. Don't talk about detailed image coordinates. Consider perspective view of the 2D image property.\n<image-placeholder>\nASSISTANT: "
